# Get commit counts for all repos owned by a Github account.
#
# Page through repos by most recent first.
# Get a count of commits and show the latest commit's details.
query CommitCountByRepo($login: String!, $since: GitTimestamp, $isFork: Boolean, $cursor: String) {
  repositoryOwner(login: $login) {
    repositories(first: 100, isFork: $isFork, after: $cursor, orderBy: {field: UPDATED_AT, direction: DESC}) {
      totalCount
      pageInfo {
        hasNextPage
        endCursor
      }
      nodes {
        name
        defaultBranch: defaultBranchRef {
          name
          commits: target {
            ... on Commit {
              history (first: 1, since: $since) {
                totalCount
                nodes {
                  committedDate
                  message
                }
              }
            }
          }
        }
      }
    }
  }
}
